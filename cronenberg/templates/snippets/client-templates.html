{% raw %}

<!-- TEMPLATE: Separator layout. Expects a context of { item: <layout-object>  } -->
<script id="tmpl-separator" data-item-type="separator" type="text/x-handlebars-template">
  <hr{{#if item.css_class}}class="{{item.css_class}}"{{/if}}></hr>
</script>

<!-- TEMPLATE: Heading layout. Expects a context of { item: <layout-object>  } -->
<script id="tmpl-heading" data-item-type="heading" type="text/x-handlebars-template">
  <h{{item.level}} {{#if item.css_class}}class="{{item.css_class}}"{{/if}}>
    {{item.text}} {{#if item.description}}<small>{{item.description}}</small>{{/if}}
  </h{{item.level}}>
</script>

<!-- TEMPLATE: Singlestat presentation. Expects a context of { item: <presentation-object>  } -->
<script id="tmpl-singlestat" data-item-type="singlestat" type="text/x-handlebars-template">
  <div class="singlestat {{item.css_class}}" id="{{item.element_id}}">
    <h3>{{item.title}}</h3>
    <p><span class="value"></span><span class="unit">{{item.units}}</span></p>
    <script>
      cronenberg.registry.queries.{{item.query_name}}.available(function(query) {
        {{#if item.index }}
          var value = query.data[{{item.index}}].summation.{{item.transform}};
        {{else}}
          var value = query.summation.{{item.transform}};
        {{/if}}
          $("#{{item.element_id}} span.value").number(value, {{item.decimal}});
      });
    </script>
  </div>
</script>

<!-- TEMPLATE: Simple time series presentation. Expects a context of { item: <presentation-object>  } -->
<script id="tmpl-simple-time-series" data-item-type="simple_time_series" type="text/x-handlebars-template">
  <div class="graph simple-time-series
              {{#if item.css_class}}{{item.css_class}}{{/if}}" id="{{item.element_id}}">
    <svg></svg>
    <script>
      cronenberg.registry.queries.{{item.query_name}}.available(function(query) {
          cronenberg.charts.simple_line_chart($("#{{item.element_id}}"), query.data[0]);
      });
    </script>
  </div>
</script>

<!-- TEMPLATE: Standard time series presentation. Expects a context of { item: <presentation-object>  } -->
<script id="tmpl-standard-time-series" data-item-type="standard_time_series" type="text/x-handlebars-template">
  <div class="graph standard-time-series
              {{#if presentation.css_class}}{{presentation.css_class}}{{/if}}" id="{{presentation.element_id}}">
    <svg></svg>
    <script>
      cronenberg.registry.queries.{{presentation.query_name}}.available(function(query) {
          cronenberg.charts.standard_line_chart($("#{{presentation.element_id}}"), query.data);
      });
  </script>
  </div>
</script>

<!-- TEMPLATE: Standard time series presentation. Expects a context of { item: <presentation-object>  } -->
<script id="tmpl-stacked-area-chart" data-item-type="stacked_area_chart" type="text/x-handlebars-template">
  <div class="graph stacked-area-chart
              {{#if presentation.css_class}}{{presentation.css_class}}{{/if}}" id="{{presentation.element_id}}">
    <svg></svg>
    <script>
      cronenberg.registry.queries.{{presentation.query_name}}.available(function(query) {
          cronenberg.charts.stacked_area_chart($("#{{presentation.element_id}}"), query.data);
      });
    </script>
  </div>
</script>

<!-- TEMPLATE: Dashboard rows. Expects a context of { item: <row>  } -->
<script id="tmpl-row" data-item-type="row" type="text/x-handlebars-template">
ROW!
</script>

<!-- TEMPLATE: Top-level dashboard. Expects a context of { item: <dashboard>  } -->
<script id="tmpl-dashboard" data-item-type="dashboard" type="text/x-handlebars-template">
{{#with item.grid}}
  {{#each rows}}
    {{item this}}
  {{/each}}
{{/with}}
</script>

<script>
  cronenberg.templates
        .register('tmpl-separator')
        .register('tmpl-heading')
        .register('tmpl-singlestat')
        .register('tmpl-simple-time-series')
        .register('tmpl-standard-time-series')
        .register('tmpl-stacked-area-chart')
        .register('tmpl-dashboard')
        .register('tmpl-row');
</script>

{% endraw %}
